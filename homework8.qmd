---
title: "Homework 8"
author: "Andy Powers"
format: html
---

# HW 8: Basic Modeling Practice

This document demonstrates use of the principles and steps to make models in R:

1.  read data
2.  EDA
3.  split data
4.  fit models
5.  apply best model

## Context

### Libraries

This work relies heavily on `tidymodels` packages and related items, so we include this and the standard `tidyverse` code.

```{r}
#| echo: false
library(tidymodels)
library(tidyverse)
```

### Dataset

The data comes from the UCI Machine Learning Repository. This set is about [bike sharing rentals](https://www4.stat.ncsu.edu/~online/datasets/SeoulBikeData.csv). More details available [here](https://archive.ics.uci.edu/dataset/560/seoul+bike+sharing+demand). The data description describes the following variables:

| FIELD                 | NOTES                                               |
|------------------------|------------------------------------------------|
| Date                  | day/month/year                                      |
| Rented Bike count     | Count of bikes rented at each hour                  |
| Hour                  | Hour of the day                                     |
| Temperature           | Temperature in Celsius                              |
| Humidity              | \%                                                  |
| Windspeed             | m/s                                                 |
| Visibility            | 10m                                                 |
| Dew point temperature | Celsius                                             |
| Solar radiation       | MJ/m2                                               |
| Rainfall              | mm                                                  |
| Snowfall              | cm                                                  |
| Seasons               | Winter, Spring, Summer, Autumn                      |
| Holiday               | Holiday/No holiday                                  |
| Functional Day        | NoFunc(Non Functional Hours), Fun(Functional hours) |

## Read data

```{r}
data_url <- "https://www4.stat.ncsu.edu/~online/datasets/SeoulBikeData.csv"
data_raw <- read_csv(
  file = data_url, 
  locale = locale(encoding = "latin1")
  )
```

## EDA

Now, I need to review the data and clean it up, then summarize it.

### 1. Check for missing values

```{r}
data_raw |> 
  map( ~sum(is.na(.)) )
```

Looks ok, no missing values (NA).

### 2. Check column types and values

Do the column types look accurate?

```{r}
str(data_raw)
```

Observations and updates required:

- Switch type to Date:
  - `Date`
- Switch type to Integer:
  - `Rented Bike Count`
  - `Hour`
- Switch character lists to Factor:
  - `Seasons`
  - `Holiday`
  - `Functioning Day`
- Rename to remove spaces across most fields

Do the numerical summaries look reasonable?

```{r}
data_raw |>
  select(where(is.numeric)) |>
  psych::describe() |>
  select(min,median,max,range,sd)
```

Nothing looks unreasonable in the numeric variable spread.

Do the categorical variable values look reasonable?

```{r}
data_raw |>
  select(where(is_character),-Date) |>
  map(unique)
```

Unique categorical values look fine as well.

### 3. Convert Date field types

Now, let's fix the Date field format.

```{r}
data_raw <- data_raw |>
  mutate(Date = as_date(Date,format="%d/%m/%Y"))
str(data_raw$Date)
```

### 4. Convert character field types

Next, turn character fields into factors.

```{r}
data_raw <- data_raw |>
  mutate(Seasons = as_factor(Seasons),
         Holiday = as_factor(Holiday),
         `Functioning Day` = as_factor(`Functioning Day`)
         )
str(select(data_raw,where(is.factor)))
```

Also, here, I will change the previously-noted fields into integers.

```{r}
data_raw <- data_raw |>
  mutate(`Rented Bike Count` = as.integer(`Rented Bike Count`),
         Hour = as.integer(Hour)
         )
str(select(data_raw,where(is_integer)))
```

### 5. Rename variables

And lastly, cleaning up the names for easier work without encoding.

```{r}
  data_raw |>
  mutate(BikeCount = `Rented Bike Count`,
         Temperature = `Temperature(°C)`,
         Humidity = `Humidity(%)`,
         WindSpeed = `Wind speed (m/s)`,
         Visibility = `Visibility (10m)`,
         DewPoint = `Dew point temperature(°C)`,
         SolarRadiation = `Solar Radiation (MJ/m2)`,
         Rainfall = `Rainfall(mm)`,
         Snowfall = `Snowfall (cm)`,
         Fu
         .keep='unused')
```


### 6a. Create summary statistics

### 6b. Review summary and subset

### 7. Summarize across hours

### 8a. Recreate summary statistics

### 8b. Explore data via plots and correlations

## Split data

BLAHBLAH 75/25, 10fold CV

## Fit models

BLAHBLAH

### Recipe 1

### Recipe 2

### Recipe 3

## Apply best model

BLAH what is best?

BLAH do it
